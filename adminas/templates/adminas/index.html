{% extends "adminas/layout.html" %}

{%  load static %}

{% block title %}
    - Home
{% endblock %}

{% block javascript %}
    <script>
        const URL_COMMENT_STATUS = '{% url "comment_status" %}';
        const URL_TODO_MANAGEMENT = '{% url "todo_list_management" %}';
    </script>
    <script src="{% static 'adminas/todo_management.js' %}" type="text/javascript"></script>
    <script src="{% static 'adminas/job_comments.js' %}" type="text/javascript"></script>
{% endblock %}

{% block body %}
    <h2>Home</h2>
    <div>
    {% for job in data %}
        <article id="todo_panel_job_{{ job.id }}" class="job-panel">
            <section class="job-details">
                <button class="todo-list-remove" data-job_id="{{ job.id }}">remove</button>
                <a href="{% url 'job' job.id %}">
                    <h4>{{ job.name }} <img src="{{ job.flag_url }}" alt="{{ job.flag_alt }}"></h4>
                    <p>
        {% if job.customer != None %}
                        {{ job.customer }}{% if job.agent != None %} (via {% endif %}
        {% endif %}
        {% if job.agent != None %}
                {{ job.agent }}{% if job.customer != None %}){% endif %}
        {% endif %}
         @ {{ job.currency }}&nbsp;{{ job.value }}
                    </p>
                    <ul>        
        {% for str_warning in job.admin_warnings.strings %}
                        <li>{{ str_warning }}</li>
        {% endfor %}    
        {% for tuple_warning in job.admin_warnings.tuples %}
                        <li>{{ tuple_warning.0 }} {{ tuple_warning.1 }}</li>
        {% endfor %} 
                    </ul>
                </a>
            </section>
            <section class="comments" data-url_comments="{% url 'job_comments' job.id %}">
                <section class="comment-container pinned">
                    {% for comment in job.pinned_comments %}
                    <article
                        class="one-comment {% if comment.private %}private{% else %}public{% endif %} id-{{ comment.id }} {% if comment.highlighted %}highlighted{% endif %}" 
                        data-comment_id="{{ comment.id }}"
                        data-is_private="{{ comment.private|lower }}"
                        data-is_pinned="true"
                        data-is_highlighted="{{ comment.highlighted }}"
                    >
                        <details>

                            <summary>
                                <span class="main">
                        {% if comment.user_is_owner %}{% if comment.private %}
                                    <div class="privacy-status">
                                        <img src="{% static 'adminas/i-private-comment.svg' %}" alt="private comment">
                                    </div>
                        {% endif %}{% endif %}
                                    <span class="contents">
                                        {{ comment.contents }}
                                    </span>
                                </span>
                            </summary>

                            <section class="footer">
                                <div class="ownership">
                                    {{ comment.created_by }} on {{ comment.created_on }}
                                </div>
                                <div class="controls">
                                    <button class="pinned-toggle pinned-status-on">unpin</button>
                                    <button class="highlighted-toggle">+/- highlight</button>
                            {% if comment.user_is_owner %}
                                    <button class="edit-comment">edit</button>
                            {% endif %}
                                </div>
                            </section>

                        </details>
                    </article>  
                    {% endfor %}
                </section>
                <div class="todo-list-add-pinned-comment-container">
                    <button class="add-job-comment-simplified" data-form_type="content-only">+ comment</button>
                </div>
            </section>
        </article>
    {% endfor %}
    </div>
{% endblock %}


