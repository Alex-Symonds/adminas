{% extends "adminas/layout.html" %}

{%  load static %}

{% block title %}
    - Home
{% endblock %}

{% block javascript %}
    <script>
        const URL_JOB_COMMENTS = null;
        const URL_TODO_MANAGEMENT = "{% url 'todo_list_management' %}";
        const MODE_COMMENT_CU = 'content_only';
    </script>
    <script src="{% static 'adminas/todo_management.js' %}" type="text/javascript"></script>
    <script src="{% static 'adminas/job_comments.js' %}" type="text/javascript"></script>
{% endblock %}

{% block body %}
    <h2>Home page</h2>

    <a href="{% url 'edit_job' %}">New Job</a>

    <div>
    {% for job in data %}
        <article id="todo_panel_job_{{ job.id }}">
            <section class="job_details">
                <button class="todo-list-remove" data-job_id="{{ job.id }}">remove</button>
                <a href="{% url 'job' job.id %}">
                    <h4>{{ job.name }} <img src="{{ job.flag_url }}" alt="{{ job.flag_alt }}"></h4>
                    <p>
        {% if job.customer != None %}
                        {{ job.customer }}{% if job.agent != None %} (via {% endif %}
        {% endif %}
        {% if job.agent != None %}
                {{ job.agent }}{% if job.customer != None %}){% endif %}
        {% endif %}
         @ {{ job.currency }}&nbsp;{{ job.value }}
                    </p>
                    <ul>        
        {% for str_warning in job.admin_warnings.strings %}
                        <li>{{ str_warning }}</li>
        {% endfor %}    
        {% for tuple_warning in job.admin_warnings.tuples %}
                        <li>{{ tuple_warning.0 }} {{ tuple_warning.1 }}</li>
        {% endfor %} 
                    </ul>
                </a>
            </section>
            <section class="pinned_comments">
                <section class="comment-container-pinned" data-url_comments="{% url 'job_comments' job.id %}">
                    {% for comment in job.pinned_comments %}
                    <article
                        class="one-comment hover-parent {% if comment.private %}private{% else %}public{% endif %} id-{{ comment.id }} {% if comment.highlighted %}highlighted{% endif %}" 
                        data-comment_id="{{ comment.id }}"
                        data-is_private="{{ comment.private|lower }}"
                        data-is_pinned="true"
                        data-is_highlighted="{{ comment.highlighted }}"
                    >
                        <section class="main">
                            <div class="contents">
                                <span>{{ comment.contents }}</span>
                            </div>
                            <div class="controls">
                                <button class="pinned-toggle pinned-status-on">unpin</button>
                        {% if comment.user_is_owner %}
                                <button class="edit-comment">edit</button>
                        {% endif %}
                            </div>
                        </section>
                        <section class="footer hover-child">
                            <div>
                                {{ comment.created_by }} on {{ comment.created_on }}
                                <span class="privacy-status">
                        {% if comment.user_is_owner %}
                            {% if comment.private %}
                                    [PRIVATE_ICON]
                            {% else %}
                                    [public_icon]
                            {% endif %}
                        {% endif %}
                                </span>
                            </div>
                        </section>
                    </article>  
                    {% endfor %}
                </section>
                <div class="todo-list-add-pinned-comment-container">
                    <button class="add_job_comment_pinned">+ comment</button>
                </div>
            </section>
        </article>
    {% endfor %}
    </div>

{% endblock %}


