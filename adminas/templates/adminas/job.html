{% extends "adminas/layout.html" %}

{% load static %}

{% block title %}
    - Job #TODO
{% endblock %}

{% block javascript %}
    <script>
        //const JOB_ID = {{ job.id }};
        //const ADD_PO_URL = "{% url 'purchase_order' %}";
    </script>
    <script src="{% static 'adminas/po_form.js' %}" type="text/javascript"></script>
    <!--<script src="https://unpkg.com/react@17/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>-->
{% endblock %}

{% block body %}
    <h2>Job {{ job.name }} for {{ job.customer.name }}</h2>
    <h3>General Details</h3>
    <div id="job_general_section">
        <h4>Identification</h4>
        <div class="read_row">
            Agent: {{ job.agent.name }}
        </div>
        <div class="read_row">
            Customer: {{ job.customer.name }}
        </div>
        <div class="read_row">
            Quote ref: {{ job.quote_ref }}
        </div>
        <div class="read_row">
            Country: {{ job.country.name }}
        </div>
        <div class="read_row">
            Language: {{ job.language }}
        </div>
    </div>

    <div class="payment_and_delivery_container">
        <div id="job_payment_section">
            <h4>Payment</h4>
            <div class="read_row panel">
                Invoice address:<br />
                {{ job.invoice_to.address }}, {{ job.invoice_to.region }}, {{ job.invoice_to.postcode }}, {{ job.invoice_to.country.name }}
            </div>
            <div class="read_row">
                Currency: {{ job.currency }}
            </div>
            <div class="read_row panel">
                Payment terms:<br />
                {{ job.payment_terms }}
            </div>
        </div>
        <div id="job_delivery_section">
            <h4>Delivery</h4>
            <div class="read_row panel">
                Delivery address:<br />
                {{ job.delivery_to.address }}, {{ job.delivery_to.region }}, {{ job.delivery_to.postcode }}, {{ job.delivery_to.country.name }}
            </div>
            <div class="read_row">
                Incoterm: {{ job.incoterm_code }} {{ job.incoterm_location }}
            </div>
        </div>
    </div>

    <div id="job_po_section">
        <h3>Purchase Order</h3>
        <div class="job_po_container">
            {% for po in po_list %}
                <div class="po_row">"{{ po.reference }}" dated {{ po.date_on_po }} for {{ po.currency }} {{ po.value_f }} [edit TODO]</div>
            {% endfor %}
        </div>
        <div class="job_po_form_container">
            <button id="show_po_form_btn">Add PO</button>
            <form method="POST" action="{% url 'purchase_order' %}" class="hide" id="po_form">
                {% csrf_token %}
                {{ po_form }}
                <input type='submit' action='submit' id='po_submit_button' value='submit'>
            </form>
        </div>
    </div>

    <div id="job_items_section">
        <h3>Items</h3>
        <div class="job_items_container">
            <form method="POST">
                {% csrf_token %}
                {{ item_formset.management_form }}
            {% for form in item_formset %}
                <div class="item_row">
                    {{ form }}
                </div>
            {% endfor %}
                <input type='submit' action='submit' id='items_submit_button' value='submit'>
            </form>
        </div>
    </div>

    <!--<script src="{% static 'adminas/scripts.jsx' %}" type="text/babel"></script>-->

{% endblock %}


